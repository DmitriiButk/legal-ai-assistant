# Юридический Ассистент для Анализа Договоров

Это приложение Streamlit представляет собой юридического ассистента, который помогает анализировать договоры и другие
юридические документы с использованием локальной языковой модели. Приложение позволяет загружать PDF-документы,
обрабатывать их содержимое и задавать вопросы, получая ответы на основе текста документа.

## Технологический Стек

- **Streamlit**: Фреймворк для создания интерактивного веб-интерфейса.
- **LangChain**: Библиотека для построения цепочек Retrieval-Augmented Generation (RAG), объединяющая ретривер и
  генеративную модель.
- **HuggingFace Transformers**: Библиотека для работы с локальными языковыми моделями, такими как
  `Qwen/Qwen2.5-1.5B-Instruct`.
- **ChromaDB**: Векторное хранилище для хранения и поиска эмбеддингов документов.
- **PyPDF**: Инструмент для извлечения текста из PDF-файлов.
- **Sentence-Transformers**: Модель для создания эмбеддингов текста (`all-MiniLM-L6-v2`).
- **Python**: Основной язык программирования.
- **Ruff**: Линтер для Python.

## Возможности

- **Загрузка документов**: Пользователи могут загружать PDF-документы для анализа.
- **Обработка документов**: Приложение разбивает документ на части, создает эмбеддинги и сохраняет их в векторное
  хранилище для поиска.
- **Ответы на вопросы**: Пользователи могут задавать вопросы о содержимом документа, получая краткие и точные ответы на
  русском языке.
- **Локальная работа**: Все вычисления выполняются локально, без обращения к внешним API, что обеспечивает
  конфиденциальность данных.
- **Аналитический режим**: При использовании ключевых слов, таких как "анализ" или "риски", приложение загружает полный
  контекст документа для более глубокого анализа.

## Как Работать с Приложением

### Установка

1. **Клонируйте репозиторий** (если вы еще этого не сделали):
   ```bash
   git clone https://github.com/DmitriiButk/legal-ai-assistant.git
   ```

2. **Создайте виртуальное окружение** (рекомендуется):
   ```bash
   python -m venv .venv
   source .venv/bin/activate  # для Linux/Mac
   # или
   .venv\Scripts\activate  # для Windows
   ```

3. **Установите зависимости**:
   Убедитесь, что вы находитесь в корневой директории проекта, и выполните:
   ```bash
   pip install -r requirements.txt
   ```
   Это установит все необходимые библиотеки, включая `streamlit`, `langchain`, `transformers` и другие.

4. **Запустите приложение**:
   После установки зависимостей выполните:
   ```bash
   streamlit run app.py
   ```
   Приложение откроется в вашем браузере по адресу `http://localhost:8501`.

### Использование

1. **Загрузите документ**:
    - В боковой панели выберите PDF-файл для анализа.
    - Нажмите кнопку "Обработать документ", чтобы приложение извлекло текст и подготовило его для вопросов.

2. **Задайте вопрос**:
    - Введите ваш вопрос о содержимом документа в поле ввода.
    - Если ваш вопрос содержит ключевые слова, такие как "анализ" или "риски", приложение загрузит полный контекст
      документа для более детального ответа.

3. **Получите ответ**:
    - Ответы отображаются в реальном времени в окне чата.
    - Все вопросы и ответы сохраняются в истории диалога.

### Качество кода

Проект использует линтер и форматер Ruff для поддержания чистоты и консистентности кодовой базы.
Рекомендуется запускать эти команды перед созданием коммита, чтобы убедиться, что код соответствует стандартам проекта.

**Выполните команды:**

```bash
    # Проверить код на наличие ошибок и стилистических проблем
    ruff check .

    # Автоматически исправить большинство найденных проблем
    ruff check . --fix

    # Отформатировать код (включая сортировку импортов)
    ruff format .
   ```

## Использование GPU для ускорения работы

Для значительного ускорения обработки документов и генерации ответов рекомендуется использовать видеокарту NVIDIA с
поддержкой CUDA.

### Шаги для настройки GPU

1. **Убедитесь, что у вас установлены последние драйверы NVIDIA**:

   Проверьте версию драйверов и поддержку CUDA с помощью команды:
   ```bash
   nvidia-smi
   ```
   В выводе найдите строку "CUDA Version". Это максимальная версия CUDA, которую поддерживают ваши драйвера.


2. **Установите правильную версию PyTorch с поддержкой CUDA**:

   Удалите текущую версию PyTorch (если она установлена):
   ```bash
   pip uninstall torch
   ```
   Установите версию PyTorch, совместимую с вашей версией CUDA (например, для CUDA 12.1):
   ```bash
   pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
   ```
   Замените cu121 на вашу версию CUDA (например, cu118 для CUDA 11.8).

3. **Переустановите зависимости, связанные с PyTorch**:

   ```bash
   pip install --force-reinstall transformers
   ```

4. **Проверьте доступность GPU в Python**:
   
  Создайте временный файл check_gpu.py с содержимым:
   ```python
    import torch
    print(f"PyTorch version: {torch.__version__}")
    print(f"CUDA доступен: {torch.cuda.is_available()}")
    if torch.cuda.is_available():
        print(f"Количество GPU: {torch.cuda.device_count()}")
        print(f"Имя устройства: {torch.cuda.get_device_name(0)}")
```
    
   Запустите его:
   ```bash
   python check_gpu.py
   ```
   Вы должны увидеть, что CUDA доступен и указано имя вашей видеокарты.

5. **Запустите приложение**: 

Теперь приложение автоматически будет использовать GPU для ускорения работы.
